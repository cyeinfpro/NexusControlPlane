{% extends "base.html" %}
{% block content %}
<div class="page-head">
  <div class="page-title">
    <h1 class="h1">æ–‡ä»¶ç®¡ç† Â· {{ site.name }}</h1>
    <div class="meta">
      <span class="meta-item">æ ¹ç›®å½•ï¼š<span class="mono">{{ root }}</span></span>
    </div>
  </div>
  <div class="right">
    <a class="btn sm ghost" href="/websites/{{ site.id }}">è¿”å›ç«™ç‚¹</a>
  </div>
</div>

{% if error %}
  <div class="flash" style="background:rgba(239,68,68,0.15);border-color:rgba(239,68,68,0.4);">
    {{ error }}
  </div>
{% endif %}

<div class="card">
  <div class="row" style="justify-content:space-between;align-items:center;">
    <div class="col">
      {% for name, p in breadcrumbs %}
        <a href="/websites/{{ site.id }}/files?path={{ p }}" class="muted" style="text-decoration:none;margin-right:6px;">{{ name }}</a>
        {% if not loop.last %}<span class="muted">/</span>{% endif %}
      {% endfor %}
    </div>
    <div class="col right">
      <form method="post" action="/websites/{{ site.id }}/files/mkdir" style="display:inline;">
        <input type="hidden" name="path" value="{{ path }}">
        <input class="input" name="name" placeholder="æ–°å»ºç›®å½•" style="max-width:160px;">
        <button class="btn xs ghost" type="submit">åˆ›å»º</button>
      </form>
      <form method="post" action="/websites/{{ site.id }}/files/upload" enctype="multipart/form-data" style="display:inline;">
        <input type="hidden" name="path" value="{{ path }}">
        <input type="file" name="file" class="input" style="max-width:200px;">
        <button class="btn xs secondary" type="submit">ä¸Šä¼ </button>
      </form>
    </div>
  </div>

  <div class="table-wrap" style="margin-top:12px;">
    <table class="table">
      <thead>
        <tr>
          <th>åç§°</th>
          <th>å¤§å°</th>
          <th>ä¿®æ”¹æ—¶é—´</th>
          <th>æ“ä½œ</th>
        </tr>
      </thead>
      <tbody>
        {% for it in items %}
        <tr>
          <td>
            {% if it.is_dir %}
              <a href="/websites/{{ site.id }}/files?path={{ it.path }}" style="text-decoration:none;">ğŸ“ {{ it.name }}</a>
            {% else %}
              {{ it.name }}
            {% endif %}
          </td>
          <td class="mono">{{ it.size_h }}</td>
          <td class="mono">{{ it.mtime or "-" }}</td>
          <td>
            {% if not it.is_dir %}
              <a class="btn xs ghost" href="/websites/{{ site.id }}/files/edit?path={{ it.path }}">ç¼–è¾‘</a>
              <a class="btn xs ghost" href="/websites/{{ site.id }}/files/download?path={{ it.path }}">ä¸‹è½½</a>
            {% endif %}
            <form method="post" action="/websites/{{ site.id }}/files/delete" style="display:inline;">
              <input type="hidden" name="path" value="{{ it.path }}">
              <button class="btn xs ghost" type="submit">åˆ é™¤</button>
            </form>
          </td>
        </tr>
        {% else %}
        <tr>
          <td colspan="4" class="muted">å½“å‰ç›®å½•ä¸ºç©º</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
